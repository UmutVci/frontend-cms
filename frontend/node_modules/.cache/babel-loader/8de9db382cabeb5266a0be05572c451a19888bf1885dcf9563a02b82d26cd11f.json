{"ast":null,"code":"import React,{useState,useEffect}from\"react\";import{useNavigate}from\"react-router-dom\";import api from\"../../../lib/axios\";import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";function generateRandomPassword(){let length=arguments.length>0&&arguments[0]!==undefined?arguments[0]:10;const chars=\"abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789!@#$%\";let pass=\"\";for(let i=0;i<length;i++){pass+=chars[Math.floor(Math.random()*chars.length)];}return pass;}export default function AddTicketClerk(){const[name,setName]=useState(\"\");const[email,setEmail]=useState(\"\");const[password,setPassword]=useState(generateRandomPassword(10));const[photo,setPhoto]=useState(null);const[preview,setPreview]=useState(\"\");const[loading,setLoading]=useState(false);const navigate=useNavigate();// İsim değiştikçe e-mail güncelle\nuseEffect(()=>{const safe=name.trim().toLowerCase().replace(/\\s+/g,\".\");setEmail(safe?\"\".concat(safe,\"@cms-clerk.com\"):\"\");},[name]);// Fotoğraf seçilince preview oluştur\nuseEffect(()=>{if(photo){const objectUrl=URL.createObjectURL(photo);setPreview(objectUrl);return()=>URL.revokeObjectURL(objectUrl);}else{setPreview(\"\");}},[photo]);const handlePhotoChange=e=>{if(e.target.files[0])setPhoto(e.target.files[0]);};const handleSubmit=async e=>{e.preventDefault();setLoading(true);// Fotoğrafı base64'e çevir (örnek)\nlet photoUrl=\"\";if(photo){const reader=new FileReader();reader.onloadend=async()=>{photoUrl=reader.result;await submitClerk(photoUrl);};reader.readAsDataURL(photo);}else{await submitClerk(photoUrl);}};const submitClerk=async photoUrl=>{const payload={name,email,password,photo:photoUrl};try{await api.post(\"/ticket-clerks\",payload);// <-- GERÇEK POST!\nalert(\"Clerk eklendi!\\n\\nEmail: \".concat(payload.email,\"\\nPassword: \").concat(payload.password));navigate(\"/admin/ticket-clerks\");}catch(err){alert(\"Bir hata oluştu: \"+err);}finally{setLoading(false);}};return/*#__PURE__*/_jsx(\"main\",{className:\"inner-container flex-1 p-10 bg-[#D9D9D9] min-h-screen\",children:/*#__PURE__*/_jsx(\"div\",{className:\"bg-white w-[75%] mx-auto my-4 rounded-xl p-10\",children:/*#__PURE__*/_jsxs(\"form\",{className:\"space-y-6\",onSubmit:handleSubmit,children:[/*#__PURE__*/_jsx(\"h2\",{className:\"text-xl font-bold text-center mb-6\",children:\"Add Ticket Clerk\"}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{className:\"block font-semibold\",children:\"Full Name\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",value:name,onChange:e=>setName(e.target.value),className:\"border rounded w-full p-3\",required:true})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{className:\"block font-semibold\",children:\"E-mail (auto)\"}),/*#__PURE__*/_jsx(\"input\",{type:\"email\",value:email,readOnly:true,disabled:true,className:\"border rounded w-full p-3 bg-gray-100 text-gray-500\"})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{className:\"block font-semibold\",children:\"Password (auto)\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",value:password,readOnly:true,disabled:true,className:\"border rounded w-full p-3 bg-gray-100 text-gray-500\"})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{className:\"block font-semibold\",children:\"Photo\"}),/*#__PURE__*/_jsx(\"input\",{type:\"file\",accept:\"image/*\",onChange:handlePhotoChange,className:\"w-full\"}),preview&&/*#__PURE__*/_jsx(\"img\",{src:preview,alt:\"Preview\",className:\"mt-4 rounded-lg w-28 h-28 object-cover\"})]}),/*#__PURE__*/_jsx(\"button\",{type:\"submit\",disabled:loading,className:\"bg-[#400505] text-white py-3 px-6 rounded-md w-full text-lg font-semibold\",children:loading?\"Adding...\":\"Add Ticket Clerk\"})]})})});}","map":{"version":3,"names":["React","useState","useEffect","useNavigate","api","jsx","_jsx","jsxs","_jsxs","generateRandomPassword","length","arguments","undefined","chars","pass","i","Math","floor","random","AddTicketClerk","name","setName","email","setEmail","password","setPassword","photo","setPhoto","preview","setPreview","loading","setLoading","navigate","safe","trim","toLowerCase","replace","concat","objectUrl","URL","createObjectURL","revokeObjectURL","handlePhotoChange","e","target","files","handleSubmit","preventDefault","photoUrl","reader","FileReader","onloadend","result","submitClerk","readAsDataURL","payload","post","alert","err","className","children","onSubmit","type","value","onChange","required","readOnly","disabled","accept","src","alt"],"sources":["/Users/umutavc/WebstormProjects/cms/src/features/admin/TicketClerks/AddTicketClerk.jsx"],"sourcesContent":["import React, { useState, useEffect } from \"react\";\nimport { useNavigate } from \"react-router-dom\";\nimport api from \"../../../lib/axios\";\n\nfunction generateRandomPassword(length = 10) {\n    const chars = \"abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789!@#$%\";\n    let pass = \"\";\n    for (let i = 0; i < length; i++) {\n        pass += chars[Math.floor(Math.random() * chars.length)];\n    }\n    return pass;\n}\n\nexport default function AddTicketClerk() {\n    const [name, setName] = useState(\"\");\n    const [email, setEmail] = useState(\"\");\n    const [password, setPassword] = useState(generateRandomPassword(10));\n    const [photo, setPhoto] = useState(null);\n    const [preview, setPreview] = useState(\"\");\n    const [loading, setLoading] = useState(false);\n\n    const navigate = useNavigate();\n\n    // İsim değiştikçe e-mail güncelle\n    useEffect(() => {\n        const safe = name.trim().toLowerCase().replace(/\\s+/g, \".\");\n        setEmail(safe ? `${safe}@cms-clerk.com` : \"\");\n    }, [name]);\n\n    // Fotoğraf seçilince preview oluştur\n    useEffect(() => {\n        if (photo) {\n            const objectUrl = URL.createObjectURL(photo);\n            setPreview(objectUrl);\n            return () => URL.revokeObjectURL(objectUrl);\n        } else {\n            setPreview(\"\");\n        }\n    }, [photo]);\n\n    const handlePhotoChange = (e) => {\n        if (e.target.files[0]) setPhoto(e.target.files[0]);\n    };\n\n    const handleSubmit = async (e) => {\n        e.preventDefault();\n        setLoading(true);\n\n        // Fotoğrafı base64'e çevir (örnek)\n        let photoUrl = \"\";\n        if (photo) {\n            const reader = new FileReader();\n            reader.onloadend = async () => {\n                photoUrl = reader.result;\n                await submitClerk(photoUrl);\n            };\n            reader.readAsDataURL(photo);\n        } else {\n            await submitClerk(photoUrl);\n        }\n    };\n\n\n    const submitClerk = async (photoUrl) => {\n        const payload = {\n            name,\n            email,\n            password,\n            photo: photoUrl\n        };\n        try {\n            await api.post(\"/ticket-clerks\", payload); // <-- GERÇEK POST!\n            alert(`Clerk eklendi!\\n\\nEmail: ${payload.email}\\nPassword: ${payload.password}`);\n            navigate(\"/admin/ticket-clerks\");\n        } catch (err) {\n            alert(\"Bir hata oluştu: \" + err);\n        } finally {\n            setLoading(false);\n        }\n    };\n\n    return (\n        <main className=\"inner-container flex-1 p-10 bg-[#D9D9D9] min-h-screen\">\n            <div className=\"bg-white w-[75%] mx-auto my-4 rounded-xl p-10\">\n                <form className=\"space-y-6\" onSubmit={handleSubmit}>\n                    <h2 className=\"text-xl font-bold text-center mb-6\">Add Ticket Clerk</h2>\n                    <div>\n                        <label className=\"block font-semibold\">Full Name</label>\n                        <input\n                            type=\"text\"\n                            value={name}\n                            onChange={e => setName(e.target.value)}\n                            className=\"border rounded w-full p-3\"\n                            required\n                        />\n                    </div>\n\n                    <div>\n                        <label className=\"block font-semibold\">E-mail (auto)</label>\n                        <input\n                            type=\"email\"\n                            value={email}\n                            readOnly\n                            disabled\n                            className=\"border rounded w-full p-3 bg-gray-100 text-gray-500\"\n                        />\n                    </div>\n\n                    <div>\n                        <label className=\"block font-semibold\">Password (auto)</label>\n                        <input\n                            type=\"text\"\n                            value={password}\n                            readOnly\n                            disabled\n                            className=\"border rounded w-full p-3 bg-gray-100 text-gray-500\"\n                        />\n                    </div>\n\n                    <div>\n                        <label className=\"block font-semibold\">Photo</label>\n                        <input\n                            type=\"file\"\n                            accept=\"image/*\"\n                            onChange={handlePhotoChange}\n                            className=\"w-full\"\n                        />\n                        {preview &&\n                            <img src={preview} alt=\"Preview\" className=\"mt-4 rounded-lg w-28 h-28 object-cover\" />\n                        }\n                    </div>\n\n                    <button\n                        type=\"submit\"\n                        disabled={loading}\n                        className=\"bg-[#400505] text-white py-3 px-6 rounded-md w-full text-lg font-semibold\"\n                    >\n                        {loading ? \"Adding...\" : \"Add Ticket Clerk\"}\n                    </button>\n                </form>\n            </div>\n        </main>\n    );\n}\n"],"mappings":"AAAA,MAAO,CAAAA,KAAK,EAAIC,QAAQ,CAAEC,SAAS,KAAQ,OAAO,CAClD,OAASC,WAAW,KAAQ,kBAAkB,CAC9C,MAAO,CAAAC,GAAG,KAAM,oBAAoB,CAAC,OAAAC,GAAA,IAAAC,IAAA,CAAAC,IAAA,IAAAC,KAAA,yBAErC,QAAS,CAAAC,sBAAsBA,CAAA,CAAc,IAAb,CAAAC,MAAM,CAAAC,SAAA,CAAAD,MAAA,IAAAC,SAAA,MAAAC,SAAA,CAAAD,SAAA,IAAG,EAAE,CACvC,KAAM,CAAAE,KAAK,CAAG,qEAAqE,CACnF,GAAI,CAAAC,IAAI,CAAG,EAAE,CACb,IAAK,GAAI,CAAAC,CAAC,CAAG,CAAC,CAAEA,CAAC,CAAGL,MAAM,CAAEK,CAAC,EAAE,CAAE,CAC7BD,IAAI,EAAID,KAAK,CAACG,IAAI,CAACC,KAAK,CAACD,IAAI,CAACE,MAAM,CAAC,CAAC,CAAGL,KAAK,CAACH,MAAM,CAAC,CAAC,CAC3D,CACA,MAAO,CAAAI,IAAI,CACf,CAEA,cAAe,SAAS,CAAAK,cAAcA,CAAA,CAAG,CACrC,KAAM,CAACC,IAAI,CAAEC,OAAO,CAAC,CAAGpB,QAAQ,CAAC,EAAE,CAAC,CACpC,KAAM,CAACqB,KAAK,CAAEC,QAAQ,CAAC,CAAGtB,QAAQ,CAAC,EAAE,CAAC,CACtC,KAAM,CAACuB,QAAQ,CAAEC,WAAW,CAAC,CAAGxB,QAAQ,CAACQ,sBAAsB,CAAC,EAAE,CAAC,CAAC,CACpE,KAAM,CAACiB,KAAK,CAAEC,QAAQ,CAAC,CAAG1B,QAAQ,CAAC,IAAI,CAAC,CACxC,KAAM,CAAC2B,OAAO,CAAEC,UAAU,CAAC,CAAG5B,QAAQ,CAAC,EAAE,CAAC,CAC1C,KAAM,CAAC6B,OAAO,CAAEC,UAAU,CAAC,CAAG9B,QAAQ,CAAC,KAAK,CAAC,CAE7C,KAAM,CAAA+B,QAAQ,CAAG7B,WAAW,CAAC,CAAC,CAE9B;AACAD,SAAS,CAAC,IAAM,CACZ,KAAM,CAAA+B,IAAI,CAAGb,IAAI,CAACc,IAAI,CAAC,CAAC,CAACC,WAAW,CAAC,CAAC,CAACC,OAAO,CAAC,MAAM,CAAE,GAAG,CAAC,CAC3Db,QAAQ,CAACU,IAAI,IAAAI,MAAA,CAAMJ,IAAI,mBAAmB,EAAE,CAAC,CACjD,CAAC,CAAE,CAACb,IAAI,CAAC,CAAC,CAEV;AACAlB,SAAS,CAAC,IAAM,CACZ,GAAIwB,KAAK,CAAE,CACP,KAAM,CAAAY,SAAS,CAAGC,GAAG,CAACC,eAAe,CAACd,KAAK,CAAC,CAC5CG,UAAU,CAACS,SAAS,CAAC,CACrB,MAAO,IAAMC,GAAG,CAACE,eAAe,CAACH,SAAS,CAAC,CAC/C,CAAC,IAAM,CACHT,UAAU,CAAC,EAAE,CAAC,CAClB,CACJ,CAAC,CAAE,CAACH,KAAK,CAAC,CAAC,CAEX,KAAM,CAAAgB,iBAAiB,CAAIC,CAAC,EAAK,CAC7B,GAAIA,CAAC,CAACC,MAAM,CAACC,KAAK,CAAC,CAAC,CAAC,CAAElB,QAAQ,CAACgB,CAAC,CAACC,MAAM,CAACC,KAAK,CAAC,CAAC,CAAC,CAAC,CACtD,CAAC,CAED,KAAM,CAAAC,YAAY,CAAG,KAAO,CAAAH,CAAC,EAAK,CAC9BA,CAAC,CAACI,cAAc,CAAC,CAAC,CAClBhB,UAAU,CAAC,IAAI,CAAC,CAEhB;AACA,GAAI,CAAAiB,QAAQ,CAAG,EAAE,CACjB,GAAItB,KAAK,CAAE,CACP,KAAM,CAAAuB,MAAM,CAAG,GAAI,CAAAC,UAAU,CAAC,CAAC,CAC/BD,MAAM,CAACE,SAAS,CAAG,SAAY,CAC3BH,QAAQ,CAAGC,MAAM,CAACG,MAAM,CACxB,KAAM,CAAAC,WAAW,CAACL,QAAQ,CAAC,CAC/B,CAAC,CACDC,MAAM,CAACK,aAAa,CAAC5B,KAAK,CAAC,CAC/B,CAAC,IAAM,CACH,KAAM,CAAA2B,WAAW,CAACL,QAAQ,CAAC,CAC/B,CACJ,CAAC,CAGD,KAAM,CAAAK,WAAW,CAAG,KAAO,CAAAL,QAAQ,EAAK,CACpC,KAAM,CAAAO,OAAO,CAAG,CACZnC,IAAI,CACJE,KAAK,CACLE,QAAQ,CACRE,KAAK,CAAEsB,QACX,CAAC,CACD,GAAI,CACA,KAAM,CAAA5C,GAAG,CAACoD,IAAI,CAAC,gBAAgB,CAAED,OAAO,CAAC,CAAE;AAC3CE,KAAK,6BAAApB,MAAA,CAA6BkB,OAAO,CAACjC,KAAK,iBAAAe,MAAA,CAAekB,OAAO,CAAC/B,QAAQ,CAAE,CAAC,CACjFQ,QAAQ,CAAC,sBAAsB,CAAC,CACpC,CAAE,MAAO0B,GAAG,CAAE,CACVD,KAAK,CAAC,mBAAmB,CAAGC,GAAG,CAAC,CACpC,CAAC,OAAS,CACN3B,UAAU,CAAC,KAAK,CAAC,CACrB,CACJ,CAAC,CAED,mBACIzB,IAAA,SAAMqD,SAAS,CAAC,uDAAuD,CAAAC,QAAA,cACnEtD,IAAA,QAAKqD,SAAS,CAAC,+CAA+C,CAAAC,QAAA,cAC1DpD,KAAA,SAAMmD,SAAS,CAAC,WAAW,CAACE,QAAQ,CAAEf,YAAa,CAAAc,QAAA,eAC/CtD,IAAA,OAAIqD,SAAS,CAAC,oCAAoC,CAAAC,QAAA,CAAC,kBAAgB,CAAI,CAAC,cACxEpD,KAAA,QAAAoD,QAAA,eACItD,IAAA,UAAOqD,SAAS,CAAC,qBAAqB,CAAAC,QAAA,CAAC,WAAS,CAAO,CAAC,cACxDtD,IAAA,UACIwD,IAAI,CAAC,MAAM,CACXC,KAAK,CAAE3C,IAAK,CACZ4C,QAAQ,CAAErB,CAAC,EAAItB,OAAO,CAACsB,CAAC,CAACC,MAAM,CAACmB,KAAK,CAAE,CACvCJ,SAAS,CAAC,2BAA2B,CACrCM,QAAQ,MACX,CAAC,EACD,CAAC,cAENzD,KAAA,QAAAoD,QAAA,eACItD,IAAA,UAAOqD,SAAS,CAAC,qBAAqB,CAAAC,QAAA,CAAC,eAAa,CAAO,CAAC,cAC5DtD,IAAA,UACIwD,IAAI,CAAC,OAAO,CACZC,KAAK,CAAEzC,KAAM,CACb4C,QAAQ,MACRC,QAAQ,MACRR,SAAS,CAAC,qDAAqD,CAClE,CAAC,EACD,CAAC,cAENnD,KAAA,QAAAoD,QAAA,eACItD,IAAA,UAAOqD,SAAS,CAAC,qBAAqB,CAAAC,QAAA,CAAC,iBAAe,CAAO,CAAC,cAC9DtD,IAAA,UACIwD,IAAI,CAAC,MAAM,CACXC,KAAK,CAAEvC,QAAS,CAChB0C,QAAQ,MACRC,QAAQ,MACRR,SAAS,CAAC,qDAAqD,CAClE,CAAC,EACD,CAAC,cAENnD,KAAA,QAAAoD,QAAA,eACItD,IAAA,UAAOqD,SAAS,CAAC,qBAAqB,CAAAC,QAAA,CAAC,OAAK,CAAO,CAAC,cACpDtD,IAAA,UACIwD,IAAI,CAAC,MAAM,CACXM,MAAM,CAAC,SAAS,CAChBJ,QAAQ,CAAEtB,iBAAkB,CAC5BiB,SAAS,CAAC,QAAQ,CACrB,CAAC,CACD/B,OAAO,eACJtB,IAAA,QAAK+D,GAAG,CAAEzC,OAAQ,CAAC0C,GAAG,CAAC,SAAS,CAACX,SAAS,CAAC,wCAAwC,CAAE,CAAC,EAEzF,CAAC,cAENrD,IAAA,WACIwD,IAAI,CAAC,QAAQ,CACbK,QAAQ,CAAErC,OAAQ,CAClB6B,SAAS,CAAC,2EAA2E,CAAAC,QAAA,CAEpF9B,OAAO,CAAG,WAAW,CAAG,kBAAkB,CACvC,CAAC,EACP,CAAC,CACN,CAAC,CACJ,CAAC,CAEf","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}